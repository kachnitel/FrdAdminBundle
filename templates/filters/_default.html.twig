{#
 # Default filter templates for per-column filtering.
 # Each renders the appropriate filter input based on type.
 #
 # Variables available:
 # @var string column - Column name
 # @var array filter - Filter metadata (type, label, etc.)
 # @var array columnFilters - Current filter values
 # @var string filterType - The filter type to render
 #}

{% if filterType == 'text' %}
    <input
        type="text"
        class="form-control form-control-sm"
        placeholder="{{ filter.placeholder|default(filter.label) }}"
        data-model="columnFilters.{{ column }}"
        value="{{ columnFilters[column]|default('') }}"
    >

{% elseif filterType == 'number' %}
    <input
        type="number"
        class="form-control form-control-sm"
        placeholder="{{ filter.placeholder|default(filter.label) }}"
        data-model="columnFilters.{{ column }}"
        value="{{ columnFilters[column]|default('') }}"
    >

{% elseif filterType == 'date' %}
    <input
        type="date"
        class="form-control form-control-sm"
        data-model="columnFilters.{{ column }}"
        value="{{ columnFilters[column]|default('') }}"
    >

{% elseif filterType == 'boolean' %}
    <select
        class="form-control form-control-sm"
        data-model="columnFilters.{{ column }}"
    >
        <option value="">All</option>
        <option value="1" {{ columnFilters[column]|default('') == '1' ? 'selected' : '' }}>Yes</option>
        <option value="0" {{ columnFilters[column]|default('') == '0' ? 'selected' : '' }}>No</option>
    </select>

{% elseif filterType == 'enum' %}
    {% if filter.enumClass is defined %}
        <select
            class="form-control form-control-sm"
            data-model="columnFilters.{{ column }}"
        >
            {% if filter.showAllOption|default(true) %}
                <option value="">All</option>
            {% endif %}
            {% for case in enum(filter.enumClass).cases() %}
                <option value="{{ case.value }}" {{ columnFilters[column]|default('') == case.value ? 'selected' : '' }}>
                    {{ case.displayValue is defined ? case.displayValue() : case.name }}
                </option>
            {% endfor %}
        </select>
    {% else %}
        <input
            type="text"
            class="form-control form-control-sm"
            placeholder="{{ filter.placeholder|default(filter.label) }}"
            data-model="columnFilters.{{ column }}"
            value="{{ columnFilters[column]|default('') }}"
        >
    {% endif %}

{% elseif filterType == 'relation' %}
    {% if filter.targetEntity is defined and filter.searchFields is defined %}
        <input
            type="text"
            class="form-control form-control-sm"
            placeholder="{{ filter.placeholder|default('Search ' ~ filter.targetEntity) }}"
            data-model="columnFilters.{{ column }}"
            value="{{ columnFilters[column]|default('') }}"
            title="Searches: {{ filter.searchFields|join(', ') }}"
        >
    {% else %}
        <input
            type="text"
            class="form-control form-control-sm"
            placeholder="{{ filter.placeholder|default(filter.label) }}"
            data-model="columnFilters.{{ column }}"
            value="{{ columnFilters[column]|default('') }}"
        >
    {% endif %}

{% endif %}
