{#
 # Default filter templates for per-column filtering.
 # Each block renders a specific filter type.
 #
 # Variables available in each block:
 # @var string column - Column name
 # @var array filter - Filter metadata (type, label, etc.)
 # @var string filterType - The filter type to render
 #}

{% if filterType == 'text' %}
    {{ block('column_filter_text') }}
{% elseif filterType == 'number' %}
    {{ block('column_filter_number') }}
{% elseif filterType == 'date' %}
    {{ block('column_filter_date') }}
{% elseif filterType == 'boolean' %}
    {{ block('column_filter_boolean') }}
{% elseif filterType == 'enum' %}
    {{ block('column_filter_enum') }}
{% elseif filterType == 'relation' %}
    {{ block('column_filter_relation') }}
{% endif %}

{# Text filter - simple input #}
{% block column_filter_text %}
    <input
        type="text"
        class="form-control form-control-sm"
        placeholder="{{ filter.placeholder|default(filter.label) }}"
        data-model="columnFilters.{{ column }}"
        value="{{ columnFilters[column]|default('') }}"
    >
{% endblock %}

{# Number filter - number input #}
{% block column_filter_number %}
    <input
        type="number"
        class="form-control form-control-sm"
        placeholder="{{ filter.placeholder|default(filter.label) }}"
        data-model="columnFilters.{{ column }}"
        value="{{ columnFilters[column]|default('') }}"
    >
{% endblock %}

{# Date filter - date input #}
{% block column_filter_date %}
    <input
        type="date"
        class="form-control form-control-sm"
        data-model="columnFilters.{{ column }}"
        value="{{ columnFilters[column]|default('') }}"
    >
{% endblock %}

{# Boolean filter - select dropdown #}
{% block column_filter_boolean %}
    <select
        class="form-control form-control-sm"
        data-model="columnFilters.{{ column }}"
    >
        <option value="">All</option>
        <option value="1" {{ columnFilters[column]|default('') == '1' ? 'selected' : '' }}>Yes</option>
        <option value="0" {{ columnFilters[column]|default('') == '0' ? 'selected' : '' }}>No</option>
    </select>
{% endblock %}

{# Enum filter - select dropdown #}
{% block column_filter_enum %}
    {% if filter.enumClass is defined %}
        <select
            class="form-control form-control-sm"
            data-model="columnFilters.{{ column }}"
        >
            {% if filter.showAllOption|default(true) %}
                <option value="">All</option>
            {% endif %}
            {% for case in enum(filter.enumClass).cases() %}
                <option value="{{ case.value }}" {{ columnFilters[column]|default('') == case.value ? 'selected' : '' }}>
                    {{ case.displayValue is defined ? case.displayValue() : case.name }}
                </option>
            {% endfor %}
        </select>
    {% else %}
        {# Fallback to text input if enumClass not provided #}
        <input
            type="text"
            class="form-control form-control-sm"
            placeholder="{{ filter.placeholder|default(filter.label) }}"
            data-model="columnFilters.{{ column }}"
            value="{{ columnFilters[column]|default('') }}"
        >
    {% endif %}
{% endblock %}

{# Relation filter - text search across related entity fields #}
{% block column_filter_relation %}
    {% if filter.targetEntity is defined and filter.searchFields is defined %}
        <input
            type="text"
            class="form-control form-control-sm"
            placeholder="{{ filter.placeholder|default('Search ' ~ filter.targetEntity) }}"
            data-model="columnFilters.{{ column }}"
            value="{{ columnFilters[column]|default('') }}"
            title="Searches: {{ filter.searchFields|join(', ') }}"
        >
    {% else %}
        {# Fallback to simple text input if relation metadata not provided #}
        <input
            type="text"
            class="form-control form-control-sm"
            placeholder="{{ filter.placeholder|default(filter.label) }}"
            data-model="columnFilters.{{ column }}"
            value="{{ columnFilters[column]|default('') }}"
        >
    {% endif %}
{% endblock %}
