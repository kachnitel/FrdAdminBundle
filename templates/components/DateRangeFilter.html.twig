{% import kachnitel_admin_theme as css %}

<div {{ attributes }}>
    {% if compact %}
        {% set popoverId = 'daterange-popover-' ~ column ~ '-' ~ random() %}
        <button
            type="button"
            popovertarget="{{ popoverId }}"
            class="{{ css.btn_outline_secondary() }} {{ css.btn_sm() }}"
        >
            ðŸ“…
            {% if from or to %}
                {% if from and to %}
                    {% if from == to %}
                        {{- from|date('M d') -}}
                    {% else %}
                        {{- from|date('M d') }} â€“ {{ to|date('M d') -}}
                    {% endif %}
                {% elseif from %}
                    {{- from|date('M d') ~ ' onwards' -}}
                {% else %}
                    {{- 'Until ' ~ to|date('M d') -}}
                {% endif %}
            {% else %}
                Select dates
            {% endif %}
        </button>
        <div popover id="{{ popoverId }}" style="position-area: top; margin: 1em;">
            <label for="{{ popoverId }}-from" class="{{ css.form_label_sm() }}">{{ column }}</label>
            <div class="{{ css.float_end() }}">
                {% if from or to %}
                    <button
                        type="button"
                        class="{{ css.btn_link() }} {{ css.btn_sm() }}"
                        data-action="live#action"
                        data-live-action-param="clear"
                    >
                        Clear
                    </button>
                {% endif %}

                <button type="button" class="{{ css.btn_close() }}" aria-label="Close" popovertarget="{{ popoverId }}"></button>
            </div>

            <div class="{{ css.flex_center() }} {{ css.gap_sm() }}">
                <input
                    id="{{ popoverId }}-from"
                    type="date"
                    class="{{ css.form_input_sm() }}"
                    data-model="from"
                    value="{{ from|default('') }}"
                    placeholder="From"
                >
                <span class="{{ css.text_muted() }}">â€“</span>
                <input
                    id="{{ popoverId }}-to"
                    type="date"
                    class="{{ css.form_input_sm() }}"
                    data-model="to"
                    value="{{ to|default('') }}"
                    placeholder="To"
                >
            </div>
        </div>
    {% else %}
        <div
            class="{{ css.flex_center() }} {{ css.gap_sm() }}"
        >
            <input
                type="date"
                class="{{ css.form_input_sm() }}"
                data-model="from"
                value="{{ from|default('') }}"
                placeholder="From"
            >
            <span class="{{ css.text_muted() }}">â€“</span>
            <input
                type="date"
                class="{{ css.form_input_sm() }}"
                data-model="to"
                value="{{ to|default('') }}"
                placeholder="To"
            >
        </div>
    {% endif %}
</div>
